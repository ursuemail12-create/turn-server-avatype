# Avatype STUN/TURN Server Configuration
# Complete production-ready configuration

# Network Configuration
listening-port=3478
tls-listening-port=5349
listening-ip=0.0.0.0
external-ip=auto-detected
relay-ip=0.0.0.0
min-port=49152
max-port=65535

# Security Settings
use-auth-secret
static-auth-secret=${TURN_AUTH_SECRET}
realm=${TURN_REALM:-turn.avatype.com}
server-name=Avatype TURN Server
no-tlsv1
no-tlsv1_1
tlsv1_2
# tlsv1_3 # Uncomment if your coturn version supports it

# Authentication
lt-cred-mech
# Long-term credentials for production
# userdb=/var/lib/coturn/turndb

# Performance Tuning
no-cli
no-stun
no-tcp-relay
no-udp-relay
stun-only
# For TURN relay, comment above and uncomment below:
# relay-threads=50
# max-bps=5000000
# bps-capacity=100000000

# Logging
syslog
simple-log
verbose
log-file=/var/log/coturn/turn.log
# For production, use less verbose:
# no-verbose

# Security Hardening
no-loopback-peers
no-multicast-peers
denied-peer-ip=10.0.0.0-10.255.255.255
denied-peer-ip=192.168.0.0-192.168.255.255
denied-peer-ip=172.16.0.0-172.31.255.255
allowed-peer-ip=0.0.0.0/0
# To prevent amplification attacks
no-udp
udp-self-threshold=3

# STUN Settings
stun-only
# If you need TURN relay, remove stun-only and configure:
# user-quota=12
# total-quota=1200
# max-bps=1000000

# Database (optional for production)
# redis-userdb="host=localhost dbname=0 password=turn connect_timeout=30"
# psql-userdb="host=localhost dbname=coturn user=turn password=turn connect_timeout=30"